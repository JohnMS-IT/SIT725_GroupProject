<div class="container my-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <h2 class="text-center mb-4">Search Products</h2>
            
            <!-- Search Form -->
            <form action="/search" method="GET" class="mb-4">
                <div class="input-group input-group-lg">
                    <input type="text" class="form-control" name="q" placeholder="Search for shoes..." 
                           value="<%= query || '' %>" id="searchInput">
                    <button class="btn btn-primary" type="submit">Search</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Search Results -->
    <% if (query) { %>
        <div class="mb-4">
            <h4>Search Results for "<%= query %>"</h4>
            <p class="text-muted">
                <% if (products && products.length > 0) { %>
                    Found <%= products.length %> product<%= products.length !== 1 ? 's' : '' %>
                <% } else { %>
                    No products found
                <% } %>
            </p>
        </div>

        <div class="row">
            <% if (products && products.length > 0) { %>
                <% products.forEach(product => { %>
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="card h-100">
                            <img src="/<%= product.image %>" class="card-img-top" alt="<%= product.name %>" style="height: 250px; object-fit: cover;">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title"><%= product.name %></h5>
                                <p class="card-text text-muted"><%= product.category %></p>
                                <% if (product.description) { %>
                                    <p class="card-text small"><%= product.description.substring(0, 80) %>...</p>
                                <% } %>
                                <div class="mt-auto">
                                    <p class="card-text"><strong>$<%= product.price %></strong></p>
                                    <div class="d-flex gap-2">
                                        <a href="/product/<%= product.id %>" class="btn btn-primary flex-fill">View Details</a>
                                        <button class="btn btn-outline-primary" onclick="addToCart(<%= product.id %>)">
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                <% }); %>
            <% } else { %>
                <div class="col-12">
                    <div class="text-center py-5">
                        <div class="mb-4">
                            <i class="fas fa-search" style="font-size: 4rem; color: #ccc;"></i>
                        </div>
                        <h4>No products found</h4>
                        <p class="text-muted">Sorry, we couldn't find any products matching "<%= query %>".</p>
                        <div class="mt-4">
                            <p><strong>Try:</strong></p>
                            <ul class="list-unstyled">
                                <li>• Checking your spelling</li>
                                <li>• Using more general keywords</li>
                                <li>• Browsing our categories</li>
                            </ul>
                        </div>
                        <a href="/shop" class="btn btn-primary mt-3">Browse All Products</a>
                    </div>
                </div>
            <% } %>
        </div>
    <% } else { %>
        <!-- Empty State -->
        <div class="text-center py-5">
            <h4>Start Your Search</h4>
            <p class="text-muted mb-4">Enter a product name or keyword to find the perfect shoes for you.</p>
            
            <!-- Popular Categories -->
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <h5>Popular Categories</h5>
                    <div class="row">
                        <% if (categories && categories.length > 0) { %>
                            <% categories.forEach(category => { %>
                                <div class="col-md-4 mb-3">
                                    <a href="/shop?category=<%= encodeURIComponent(category) %>" class="btn btn-outline-primary w-100">
                                        <%= category %>
                                    </a>
                                </div>
                            <% }); %>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
    <% } %>
</div>

<script>
    // Auto-focus search input
    document.getElementById('searchInput').focus();

    function addToCart(productId) {
        alert('Product added to cart! (Cart functionality not implemented yet)');
    }

    // Live search suggestions (placeholder for future enhancement)
    document.getElementById('searchInput').addEventListener('input', function() {
        // This could be enhanced with AJAX live search suggestions
    });
</script>

